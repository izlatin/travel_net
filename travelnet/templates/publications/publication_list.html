{% extends "base.html" %}
{% load static %}

{% block title %}Ваша лента{% endblock %}

{% block content %}
{% if user.is_authenticated %}
{% include "includes/create_publication.html" with form=new_publication_form %}
{% endif %}
<div class="infinite-container">
    {% for post in publications %}
     <div class="infinite-item">{% include "includes/publication.html" %}</div>
    {% empty %}
    <p>Хм, никто ничего не опубликовал. Эй, админ, добавь что-нибудь!</p>
    {% endfor %}
</div>

<div class="d-flex justify-content-center" style="display: none;">
    <div class="loading spinner-border text-primary" role="status"></div>
</div>

{% if publications.has_next %}
    <a class="infinite-more-link" href="?page={{ publications.next_page_number }}">More</a>
{% endif %}

<script>
    var infinite = new Waypoint.Infinite({
      element: $('.infinite-container')[0],
      onBeforePageLoad: function () {
        $('.loading').show();
      },
      onAfterPageLoad: function ($items) {
        $('.loading').hide();
      }
    });
</script>

{% endblock %}